
# 1. 用一条 sql 语句查询出每门课都大于 80 分的学生

| name | course | score |
| ---- | ------ | ----- |
| 张三   | 数学     | 85    |
| 张三   | 英语     | 90    |
| 李四   | 数学     | 75    |
| 李四   | 英语     | 88    |
| 王五   | 数学     | 92    |
| 王五   | 英语     | 95    |


```sql
select name from t_student group by name having min(score) > 80;
```

****
# 2. 模拟数据

![](images/企业真题/file-20250521134216.png)

其中，两个表的关联字段为申请单号。

先把两个表格写出来：

表1：g_cardapply

| g_applyno | g_applydate | g_state |
| --------- | ----------- | ------- |
| 1         | 2008/8/8    | 01      |
| 2         | 2022/10/11  | 01      |
| 3         | 2023/3/23   | 01      |
| 4         | 2007/12/12  | 02      |
| 5         | 2009/12/11  | 02      |

表2：g_cardapplydetail

| g_applyno | g_name | g_idcard        | g_state |
| --------- | ------ | --------------- | ------- |
| 1         | 张三     | 440401430103082 | 01      |
| 2         | 张三     | 440401430103082 | 01      |
| 3         | 张三     | 440401430103082 | 01      |
| 4         | 李四     | 540401265323220 | 02      |
| 5         | 王五     | 550401430103000 | 02      |

1）查询身份证号为 440401430103082 的申请日期。 

```sql
select a.g_applydate from g_cardapply a join g_cardapplydetail b on a.g_applyno = b.g_applyno where b.g_idcard = `440401430103082`
```

2）查询同一个身份证号码有两条以上记录的身份证号码及记录个数。 

```sql
select g_idcard,count(g_idcard) from g_cardapplydetail group by g_idcard having count(g_idcard) > 2;
```

3）将身份证号码为 440401430103082 的记录在两个表中的申请状态均改为 07。 

```sql
update g_cardapply a join g_cardapplydetail b on a.g_applyno = b.g_applyno and a.g_idcard = 440401430103082 set a.g_state = 07,b.g_state = 07;
```

4）删除 g_cardapplydetail 表中所有姓李的记录。

```sql
delete a,b from g_cardapply a join g_cardapplydetail b on a.g_applyno = b.g_applyno where b.g_name like '李%';
```

****
# 3. 

| Name | subject | score | studi |
| ---- | ------- | ----- | ----- |
| 张三   | 数学      | 89    | 1     |
| 张三   | 语文      | 80    | 1     |
| 张三   | 英语      | 70    | 1     |
| 李四   | 数学      | 90    | 2     |
| 李四   | 语文      | 70    | 2     |
| 李四   | 英语      | 80    | 2     |

（1）成绩统计：不及格（0-59）？个、良（60-80）？个、优（81-100）？个：

```sql
select 
	case 
	when score >= 0 and score <= 59 then '不及格',
	when score >= 60 and score <= 80 then '良',
	when score >= 81 and score <= 100 then '优'
	as 分数等级, 
```

（2）每科都及格的人的平均成绩：




