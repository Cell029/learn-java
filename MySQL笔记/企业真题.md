
# 1. 用一条 sql 语句查询出每门课都大于 80 分的学生

| name | course | score |
| ---- | ------ | ----- |
| 张三   | 数学     | 85    |
| 张三   | 英语     | 90    |
| 李四   | 数学     | 75    |
| 李四   | 英语     | 88    |
| 王五   | 数学     | 92    |
| 王五   | 英语     | 95    |


```sql
select name from t_student group by name having min(score) > 80;
```

****
# 2. 模拟数据

![](images/企业真题/file-20250521134216.png)

其中，两个表的关联字段为申请单号。

先把两个表格写出来：

表1：g_cardapply

| g_applyno | g_applydate | g_state |
| --------- | ----------- | ------- |
| 1         | 2008/8/8    | 01      |
| 2         | 2022/10/11  | 01      |
| 3         | 2023/3/23   | 01      |
| 4         | 2007/12/12  | 02      |
| 5         | 2009/12/11  | 02      |

表2：g_cardapplydetail

| g_applyno | g_name | g_idcard        | g_state |
| --------- | ------ | --------------- | ------- |
| 1         | 张三     | 440401430103082 | 01      |
| 2         | 张三     | 440401430103082 | 01      |
| 3         | 张三     | 440401430103082 | 01      |
| 4         | 李四     | 540401265323220 | 02      |
| 5         | 王五     | 550401430103000 | 02      |

1）查询身份证号为 440401430103082 的申请日期。 

```sql
select a.g_applydate from g_cardapply a join g_cardapplydetail b on a.g_applyno = b.g_applyno where b.g_idcard = `440401430103082`
```

2）查询同一个身份证号码有两条以上记录的身份证号码及记录个数。 

```sql
select g_idcard,count(g_idcard) from g_cardapplydetail group by g_idcard having count(g_idcard) > 2;
```

3）将身份证号码为 440401430103082 的记录在两个表中的申请状态均改为 07。 

```sql
update g_cardapply a join g_cardapplydetail b on a.g_applyno = b.g_applyno and a.g_idcard = 440401430103082 set a.g_state = 07,b.g_state = 07;
```

4）删除 g_cardapplydetail 表中所有姓李的记录。

```sql
delete a,b from g_cardapply a join g_cardapplydetail b on a.g_applyno = b.g_applyno where b.g_name like '李%';
```

****
# 3. 统计

| Name | subject | score | studi |
| ---- | ------- | ----- | ----- |
| 张三   | 数学      | 89    | 1     |
| 张三   | 语文      | 80    | 1     |
| 张三   | 英语      | 70    | 1     |
| 李四   | 数学      | 90    | 2     |
| 李四   | 语文      | 70    | 2     |
| 李四   | 英语      | 80    | 2     |

（1）成绩统计：不及格（0-59）？个、良（60-80）？个、优（81-100）？个：

```sql
SELECT
  CASE
    WHEN score BETWEEN 0 AND 59 THEN '不及格'
    WHEN score BETWEEN 60 AND 80 THEN '良'
    WHEN score BETWEEN 81 AND 100 THEN '优'
  END AS 分数等级,
  COUNT(*) AS 人数
FROM stuscore
GROUP BY 分数等级;
```

（2）每科都及格的人的平均成绩：

```sql
select name,avg(score) from stuscore where studi in (select studi from stuscore group by studi having min(score) >= 60);
```

****
# 4. 系统有一个表 WCMEmploy （职工号，姓名，部门名，工种，工资），若需查询不同部门中担任 “钳工” 工种的职工的平均工资：

先画出表：employ

| empno | ename | dept | job | salary |
| ----- | ----- | ---- | --- | ------ |
| E001  | 张三    | 生产部  | 钳工  | 2200   |
| E002  | 李四    | 生产部  | 焊工  | 2000   |
| E003  | 王五    | 装配部  | 钳工  | 1800   |
| E004  | 赵六    | 装配部  | 钳工  | 2100   |
| E005  | 孙七    | 维修部  | 电工  | 2500   |
| E006  | 周八    | 装配部  | 钳工  | 2400   |
| E007  | 吴九    | 生产部  | 钳工  | 2000   |

（1）请用一个 SQL 语句查询出不同部门中担任 “钳工” 的职工平均工资。

```sql
select ename,dept,avg(salary) from employ where job = '钳工' group by dept;
```

（2）请用一个 SQL 语句查询出不同部门中担任 “钳工” 的职工平均工资高于 2 千的部门。

```sql
select ename,dept,avg(salary) from employ where job = '钳工' group by dept having sag(salary) > 2000;
```

****
# 5. 

Employee是雇员信息表： 

>雇员姓名（主键）：person-name ；街道：street ；城市：city ；

Company是公司信息表： 

>公司名称（主键）：company-name； 城市：city ；

Works是雇员工作信息表：

>雇员姓名（主键）：person-name； 公司名称：company-name ；年薪：salary ；

Manages是雇员工作关系表： 

>雇员姓名（主键）：person-name ；经理姓名：manager-name；

先画出表格：

employee：

| person-name | street       | city    |
|-------------|--------------|---------|
| bob         | 桃园一路     | 天津    |
| frank       | 蒲松龄街道   | 天津    |
| jack        | 南开一街     | 天津    |
| lucy        | 文化园一路   | 天津    |
| 周二        | 长安区       | 石家庄  |
| 张三        | 大兴区       | 北京    |
| 李四        | 海淀区       | 北京    |
| 王五        | 朝阳区       | 北京    |
| 赵六        | 裕华区       | 石家庄  |
| 钱七        | 新华区       | 石家庄  |

company：

| company-name          | city    |
|-----------------------|---------|
| Small Bank Corporation | 北京    |
| 公司B                | 石家庄  |
| 公司C                | 天津    |

works：

| person-name | company-name          | salary   |
|-------------|-----------------------|----------|
| bob         | 公司C                | 22000.00 |
| frank       | 公司C                | 99999.00 |
| jack        | 公司C                | 6000.00  |
| lucy        | 公司C                | 11000.00 |
| 周二        | 公司B                | 31000.00 |
| 张三        | Small Bank Corporation | 11000.00 |
| 李四        | Small Bank Corporation | 5000.00  |
| 王五        | Small Bank Corporation | 8000.00  |
| 赵六        | 公司B                | 12000.00 |
| 钱七        | 公司B                | 21000.00 |

manages：

| person-name | manager-name |
| ----------- | ------------ |
| bob         | frank        |
| frank       |              |
| jack        | lucy         |
| lucy        | bob          |
| 周二          | jack         |
| 张三          | 李四           |
| 李四          | 王五           |
| 王五          | 赵六           |
| 赵六          | 钱七           |
| 钱七          | 周二           |

（1）找出所有居住地与工作的公司在同一城市的员工的姓名。

```sql

```

（2）找出比Small Bank Corporation的所有员工收入都高的所有员工的姓名。

（3）找出平均年薪在10000美元以上的公司及其平均年薪。